{% extends 'base.html' %}
{% block content %}

<h3>{{ game.away_team }} @ {{ game.home_team }}</h3>
<p><strong>Start:</strong> {{ game.start_time.strftime('%Y-%m-%d %H:%M') }} | <strong>Status:</strong> {{ game.status }}</p>
<hr>
{% extends 'base.html' %}
{% block content %}

<h3>{{ game.away_team }} @ {{ game.home_team }}</h3>
<p><strong>Start:</strong> {{ game.start_time.strftime('%Y-%m-%d %H:%M') }} | <strong>Status:</strong> {{ game.status }}</p>
<hr>

{% if game.status == 'open' %}
<div class="row mb-2">
    <div class="col-md-4"><div class="text-center text-uppercase text-muted fw-semibold small">Moneyline</div></div>
    <div class="col-md-4"><div class="text-center text-uppercase text-muted fw-semibold small">Spread</div></div>
    <div class="col-md-4"><div class="text-center text-uppercase text-muted fw-semibold small">Total</div></div>
</div>

<div class="row g-3">

    <div class="col-md-4 d-grid gap-2">
        {% if game.ml_home is not none and game.ml_away is not none %}
        <form action="{{ url_for('place_bet') }}" method="POST">
            <input type="hidden" name="game_id" value="{{ game.id }}">
            <input type="hidden" name="bet_type" value="ML">
            <input type="hidden" name="selection" value="HOME">
            <div class="input-group">
                <button class="btn btn-light w-50" type="submit">HOME ({{ game.ml_home }})</button>
                <span class="input-group-text">$</span>
                <input type="number" name="stake" class="form-control" placeholder="Stake" required step="0.01" min="0.01">
            </div>
        </form>
        <form action="{{ url_for('place_bet') }}" method="POST">
            <input type="hidden" name="game_id" value="{{ game.id }}">
            <input type="hidden" name="bet_type" value="ML">
            <input type="hidden" name="selection" value="AWAY">
            <div class="input-group">
                <button class="btn btn-light w-50" type="submit">AWAY ({{ game.ml_away }})</button>
                <span class="input-group-text">$</span>
                <input type="number" name="stake" class="form-control" placeholder="Stake" required step="0.01" min="0.01">
            </div>
        </form>
        {% else %}
        <p class="text-muted text-center mb-0">No moneyline offered.</p>
        {% endif %}
    </div>

    <div class="col-md-4 d-grid gap-2">
        {% if game.spread_line is not none %}
        <form action="{{ url_for('place_bet') }}" method="POST">
            <input type="hidden" name="game_id" value="{{ game.id }}">
            <input type="hidden" name="bet_type" value="SPREAD">
            <input type="hidden" name="selection" value="HOME">
            <div class="input-group">
                <button class="btn btn-light w-50" type="submit">HOME {{ game.spread_line }} ({{ game.spread_home_odds }})</button>
                <span class="input-group-text">$</span>
                <input type="number" name="stake" class="form-control" placeholder="Stake" required step="0.01" min="0.01">
            </div>
        </form>
        <form action="{{ url_for('place_bet') }}" method="POST">
            <input type="hidden" name="game_id" value="{{ game.id }}">
            <input type="hidden" name="bet_type" value="SPREAD">
            <input type="hidden" name="selection" value="AWAY">
            <div class="input-group">
                <button class="btn btn-light w-50" type="submit">AWAY {{ -game.spread_line }} ({{ game.spread_away_odds }})</button>
                <span class="input-group-text">$</span>
                <input type="number" name="stake" class="form-control" placeholder="Stake" required step="0.01" min="0.01">
            </div>
        </form>
        {% else %}
        <p class="text-muted text-center mb-0">No spread offered.</p>
        {% endif %}
    </div>

    <div class="col-md-4 d-grid gap-2">
        {% if game.total_points is not none %}
        <form action="{{ url_for('place_bet') }}" method="POST">
            <input type="hidden" name="game_id" value="{{ game.id }}">
            <input type="hidden" name="bet_type" value="TOTAL">
            <input type="hidden" name="selection" value="OVER">
            <div class="input-group">
                <button class="btn btn-light w-50" type="submit">OVER {{ game.total_points }} ({{ game.over_odds }})</button>
                <span class="input-group-text">$</span>
                <input type="number" name="stake" class="form-control" placeholder="Stake" required step="0.01" min="0.01">
            </div>
        </form>
        <form action="{{ url_for('place_bet') }}" method="POST">
            <input type="hidden" name="game_id" value="{{ game.id }}">
            <input type="hidden" name="bet_type" value="TOTAL">
            <input type="hidden" name="selection" value="UNDER">
            <div class="input-group">
                <button class="btn btn-light w-50" type="submit">UNDER {{ game.total_points }} ({{ game.under_odds }})</button>
                <span class="input-group-text">$</span>
                <input type="number" name="stake" class="form-control" placeholder="Stake" required step="0.01" min="0.01">
            </div>
        </form>
        {% else %}
        <p class="text-muted text-center mb-0">No total offered.</p>
        {% endif %}
    </div>
</div>

{% if game.props %}
<hr>
<h5 class="mb-3">Props</h5>
<div class="row g-3">
    {% for p in game.props if p.status != 'closed' %}
    <div class="col-md-6">
        <div class="fw-semibold mb-2">{{ p.name }}</div>
        {% if p.prop_type == 'OU' %}
        <div class="d-flex gap-2">
            <form action="{{ url_for('place_bet') }}" method="POST" class="w-100">
                <input type="hidden" name="prop_id" value="{{ p.id }}">
                <input type="hidden" name="bet_type" value="PROP">
                <input type="hidden" name="selection" value="OVER">
                <div class="input-group">
                    <button class="btn btn-light w-50" type="submit">Over {{ '%.2f'|format(p.line) }} ({{ p.over_odds }})</button>
                    <span class="input-group-text">$</span>
                    <input type="number" name="stake" class="form-control" placeholder="Stake" required step="0.01" min="0.01">
                </div>
            </form>
            <form action="{{ url_for('place_bet') }}" method="POST" class="w-100">
                <input type="hidden" name="prop_id" value="{{ p.id }}">
                <input type="hidden" name="bet_type" value="PROP">
                <input type="hidden" name="selection" value="UNDER">
                <div class="input-group">
                    <button class="btn btn-light w-50" type="submit">Under {{ '%.2f'|format(p.line) }} ({{ p.under_odds }})</button>
                    <span class="input-group-text">$</span>
                    <input type="number" name="stake" class="form-control" placeholder="Stake" required step="0.01" min="0.01">
                </div>
            </form>
        </div>
        {% else %} {# YN Props #}
        <div class="d-flex gap-2">
            <form action="{{ url_for('place_bet') }}" method="POST" class="w-100">
                <input type="hidden" name="prop_id" value="{{ p.id }}">
                <input type="hidden" name="bet_type" value="PROP">
                <input type="hidden" name="selection" value="YES">
                <div class="input-group">
                    <button class="btn btn-light w-50" type="submit">YES ({{ p.yes_odds }})</button>
                    <span class="input-group-text">$</span>
                    <input type="number" name="stake" class="form-control" placeholder="Stake" required step="0.01" min="0.01">
                </div>
            </form>
            <form action="{{ url_for('place_bet') }}" method="POST" class="w-100">
                <input type="hidden" name="prop_id" value="{{ p.id }}">
                <input type="hidden" name="bet_type" value="PROP">
                <input type="hidden" name="selection" value="NO">
                <div class="input-group">
                    <button class="btn btn-light w-50" type="submit">NO ({{ p.no_odds }})</button>
                    <span class="input-group-text">$</span>
                    <input type="number" name="stake" class="form-control" placeholder="Stake" required step="0.01" min="0.01">
                </div>
            </form>
        </div>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% endif %}

{% else %}
<p class="text-muted">Betting is closed for this game.</p>
{% endif %}

{% endblock %}